<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE muclient>

<!-- Bits of this plugin and ideas were borrowed and remixed from the MUSHclient community. http://www.gammon.com.au/forum/?id=9385 and others. -->
<!-- Modifications for Aardwolf and extra awesome sauce added by Fiendish with help from Orogan -->
<!-- Adapated by Nick Gammon for Smaug and similar MUDs -->

<muclient>
    <plugin
    name="DBNU_Chat_Capture_Miniwindow"
    author="Braska"
    id="565dae21eb816a2fdb8d50f9"
    language="Lua"
    purpose="Move chats to a miniwindow"
    date_written="2010-04-04"
    date_modified="2020-04-27"
    requires="4.52"
    version="2.4"
    save_state="y"
    >
    
<description trim="y">
USAGE:

  chats echo on    : echo chats in main window
  chats echo off   : do not echo chats
  chats show       : show chats window
  chats hide       : hide chats window
  
  LH-click a line to copy it to the clipboard
  RH-click main window to see menu of options
  
  Click title bar to drag window.
</description>
  
</plugin>

<triggers>
    
	<trigger
   enabled="y"
   match="<(OOC|IMM)> {(.+)} \((.+)\) ([a-zA-Z]+) \'(.*?)\'$"
   omit_from_output="y"
   regexp="y"
   script="channel_chats"
   sequence="100"
  >
  </trigger>	

	<trigger
   enabled="y"
   match="\<OOC\> \*(.*?)\*$"
   omit_from_output="y"
   regexp="y"
   script="channel_chats"
   sequence="100"
  >
  </trigger>	

  <trigger
   enabled="y"
   match="<(IMM|Race)> Someone \'(.*?)\'$"
   omit_from_output="y"
   regexp="y"
   script="channel_chats"
   sequence="100"
  >
  </trigger>

  <trigger
   enabled="y"
   match="\<Clan\> (.*?) '(.*?)'$"
   omit_from_output="y"
   regexp="y"
   script="channel_chats"
   sequence="100"
  >
  </trigger>	
	
  <trigger
   enabled="y"
   match="<<(OOC|IMM)>> (.*?)$"
   omit_from_output="y"
   regexp="y"
   script="channel_chats"
   sequence="100"
  >
  </trigger>

  <trigger
   enabled="y"
   match="\[(WAR|MUSIC|New-Player|Ask|Answer|Immortal)\] (.+) \'(.*?)\'$"
   omit_from_output="y"
   regexp="y"
   script="channel_chats"
   sequence="100"
  >
  </trigger>

  <trigger
   enabled="y"
   match="\{(Area-Yell|FriendChat)\} (.+) \'(.*?)\'$"
   omit_from_output="y"
   regexp="y"
   script="channel_chats"
   sequence="100"
  >
  </trigger>
  
    <trigger
   enabled="y"
   match="<(Race)> \((.+)\) ([a-zA-Z]+) \'(.*?)\'$"
   omit_from_output="y"
   regexp="y"
   script="channel_chats"
   sequence="100"
  >
  </trigger>

    <trigger
   enabled="y"
   match="\[(Scouter - Private)\] ([a-zA-Z]+) tells you \'(.*?)\'"
   omit_from_output="y"
   regexp="y"
   script="channel_chats"
   sequence="100"
  >
  </trigger> 

    <trigger
   enabled="y"
   match="\[(Scouter - Private)\] To ([a-zA-Z]+) \'(.*?)\'"
   omit_from_output="y"
   regexp="y"
   script="channel_chats"
   sequence="100"
  >
  </trigger> 

    <trigger
   enabled="y"
   match="\[NEWS-FLASH\] :: (.*?) ::$"
   omit_from_output="y"
   regexp="y"
   script="event_chats"
   sequence="100"
  >
  </trigger>  

  <trigger
   enabled="y"
   match="\[(Info|HighScore)\] -> (.+)$"
   omit_from_output="y"
   regexp="y"
   script="event_chats"
   sequence="100"
  >
  </trigger>
    
    <trigger
   enabled="y"
   match="\[(Auto-Event)\] -> (.*?)$"
   omit_from_output="y"
   regexp="y"
   script="event_chats"
   sequence="100"
  >
  </trigger>

    <trigger
   enabled="y"
   match="\[Clan-Info\] -> (.*?) has been inducted to (.*?)!$"
   omit_from_output="y"
   regexp="y"
   script="event_chats"
   sequence="100"
  >
  </trigger>

    <trigger
   enabled="y"
   match="\[DBNU Auction House\] -> The item \[(.*?)\] is being auctioned for \[(.*?)\] Zeni by the player (.*?)$"
   omit_from_output="y"
   regexp="y"
   script="event_chats"
   sequence="100"
  >
  </trigger>  
    
    <trigger
   enabled="y"
   match="\[DBNU Auction House\] -> \[(.*?)\] is going (.*?) \((.*?)\)$"
   omit_from_output="y"
   regexp="y"
   script="event_chats"
   sequence="100"
  >
  </trigger>  
  
    <trigger
   enabled="y"
   match="\[DBNU Auction House\] -> No bids received for \[(.*?)\]  - It has been removed from auction house\.$"
   omit_from_output="y"
   regexp="y"
   script="event_chats"
   sequence="100"
  >
  </trigger>  
  
    <trigger
   enabled="y"
   match="\[DBNU Auction House\] -> (.*?) has placed bid of \[(.*?)\] Zeni on \[(.*?)\]$"
   omit_from_output="y"
   regexp="y"
   script="event_chats"
   sequence="100"
  >
  </trigger>  
  
    <trigger
   enabled="y"
   match="\[DBNU Auction House\] -> \[(.*?)\] is going (.*?) for \[(.*?)\]$"
   omit_from_output="y"
   regexp="y"
   script="event_chats"
   sequence="100"
  >
  </trigger>  
  
    <trigger
   enabled="y"
   match="\[DBNU Auction House\] -> \[(.*?)\] SOLD to (.*?) for \[(.*?)\]\!$"
   omit_from_output="y"
   regexp="y"
   script="event_chats"
   sequence="100"
  >
  </trigger>  
  
    <trigger
   enabled="y"
   match="The auctioneer pays you (.*?) zeni, charging an auction fee of (.*?).$"
   omit_from_output="y"
   regexp="y"
   script="event_chats"
   sequence="100"
  >
  </trigger>  
  
    <trigger
   enabled="y"
   match="The auctioneer materializes before you, and hands you (.*?).$"
   omit_from_output="y"
   regexp="y"
   script="event_chats"
   sequence="100"
  >
  </trigger>  
  
    <trigger
   enabled="y"
   match="The auctioneer appears before you to return (.*?) to you\.$"
   omit_from_output="y"
   regexp="y"
   script="event_chats"
   sequence="100"
  >
  </trigger> 

</triggers>

<aliases>
    <alias
    script="chat_echo"
    match="^chats echo( on| off)?$"
    enabled="y"
    regexp="y"
    sequence="100"
    ignore_case="y"
    ></alias>

    <alias
    script="chat_show"
    match="chats show"
    enabled="y"
    sequence="100"
    ignore_case="y"
    ></alias>

    <alias
    script="chat_hide"
    match="chats hide"
    enabled="y"
    sequence="100"
    ignore_case="y"
    ></alias>
        
</aliases>

<script>

dofile (GetPluginInfo (GetPluginID (), 20) .. "My_Chat_Window.lua")

function event_chats (name, line, wildcards, styles)
  Win = Event_Win  -- switch to the Group window name
  CHAT_WINDOW_NAME = "Events"
  lines = Event_lines  -- and the group lines
  rawlines = Event_rawlines  -- and the group rawlines
  chats (name, line, wildcards, styles) -- call the usual function
end -- event_chats

function channel_chats (name, line, wildcards, styles)
  Win = Channel_Win  -- switch to the Group window name
  CHAT_WINDOW_NAME = "Channels"
  lines = Channel_lines  -- and the channel lines
  rawlines = Channel_rawlines  -- and the channel rawlines
  chats (name, line, wildcards, styles) -- call the usual function
end -- channel_chats





</script>
</muclient>
